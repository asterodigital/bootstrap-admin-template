---
import AdminLayout from "../../../layouts/admin/admin-layout.astro";
import PageHeader from "../../../components/common/page-header.astro";
import { getAssetPrefix, getPathPrefix } from "../../../../utils/path.js";

const pageHeaderProps = {
  title: "View Role",
  breadcrumbs: [
    { label: "Dashboard", href: getPathPrefix("/dashboard") },
    { label: "Roles & Permissions", href: getPathPrefix("/roles_permissions") },
    { label: "Roles", href: getPathPrefix("/roles_permissions/roles/list") }
  ],
  actions: [
    {
      label: "Back",
      href: getPathPrefix("/roles_permissions/roles/list"),
      variant: "btn-outline-primary",
      icon: "ri-arrow-left-s-line"
    },
    {
      label: "Edit Role",
      href: getPathPrefix("/roles_permissions/roles/edit"),
      variant: "btn-primary",
      icon: "ri-edit-2-line"
    }
  ]
};

// Define permissions data structure
const modules = [
  {
    id: "cms",
    name: "CMS",
    groups: [
      {
        id: "content_management",
        name: "Content Management",
        permissions: [
          { id: "view_cms", name: "View CMS" },
          { id: "edit_cms", name: "Edit CMS" },
          { id: "manage_pages", name: "Manage Pages" },
          { id: "manage_posts", name: "Manage Posts" },
          { id: "manage_comments", name: "Manage Comments" }
        ]
      },
      {
        id: "media_management",
        name: "Media Management",
        permissions: [{ id: "manage_media", name: "Manage Media" }]
      },
      {
        id: "content_organization",
        name: "Content Organization",
        permissions: [
          { id: "manage_categories", name: "Manage Categories" },
          { id: "manage_tags", name: "Manage Tags" }
        ]
      }
    ]
  },
  {
    id: "seo",
    name: "SEO",
    groups: [
      {
        id: "seo_management",
        name: "SEO Management",
        permissions: [
          { id: "manage_seo", name: "Manage SEO" },
          { id: "manage_meta", name: "Manage Meta Tags" }
        ]
      },
      {
        id: "analytics",
        name: "Analytics",
        permissions: [{ id: "view_analytics", name: "View Analytics" }]
      },
      {
        id: "url_management",
        name: "URL Management",
        permissions: [{ id: "manage_redirects", name: "Manage Redirects" }]
      }
    ]
  },
  {
    id: "system",
    name: "System",
    groups: [
      {
        id: "user_management",
        name: "User Management",
        permissions: [
          { id: "manage_users", name: "Manage Users" },
          { id: "manage_roles", name: "Manage Roles" }
        ]
      },
      {
        id: "system_settings",
        name: "System Settings",
        permissions: [{ id: "manage_settings", name: "Manage Settings" }]
      },
      {
        id: "system_maintenance",
        name: "System Maintenance",
        permissions: [
          { id: "manage_backups", name: "Manage Backups" },
          { id: "manage_cache", name: "Manage Cache" }
        ]
      },
      {
        id: "system_monitoring",
        name: "System Monitoring",
        permissions: [{ id: "view_logs", name: "View Logs" }]
      },
      {
        id: "api_management",
        name: "API Management",
        permissions: [{ id: "manage_api", name: "Manage API" }]
      }
    ]
  }
];

const selectedPermissions = [
  { id: "view_cms", name: "View CMS" },
  { id: "edit_cms", name: "Edit CMS" },
  { id: "manage_pages", name: "Manage Pages" },
  { id: "manage_posts", name: "Manage Posts" },
  { id: "manage_seo", name: "Manage SEO" },
  { id: "manage_meta", name: "Manage Meta Tags" },
  { id: "view_analytics", name: "View Analytics" },
  { id: "manage_redirects", name: "Manage Redirects" },
  { id: "manage_users", name: "Manage Users" },
  { id: "manage_roles", name: "Manage Roles" }
];
---

<AdminLayout title="View Role" description="View Role" currentPath="roles_permissions/roles/view">
  <PageHeader {...pageHeaderProps} />
  <div class="row">
    <div class="col-12 col-md-3 mb-3">
      <div class="card">
        <div class="card-header">
          <h5 class="fw-semibold text-capitalize mb-2">administrator</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              <!-- display total users with this role -->
              <div class="card-text mb-2">
                <strong>Users:</strong>
                <span class="text-muted ms-2">2</span>
              </div>
              <div class="card-text mb-2">
                <strong>Granted Permissions:</strong>
                <span class="text-muted">10</span>
              </div>
              <div class="card-text mb-2">
                <strong>Added On:</strong>
                <span class="text-muted">10/26/2023 18:45</span>
              </div>
            </div>
          </div>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <a
            href={getPathPrefix("/roles_permissions/roles/edit")}
            class="btn btn-sm btn-primary px-3 py-1">Edit Role</a
          >
        </div>
      </div>
    </div>
    <div class="col-12 col-md-9">
      <div class="card">
        <div class="card-header">
          <h5 class="fw-semibold text-capitalize mb-2">Granted Permissions</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              {
                modules.map((module, moduleIndex) => (
                  <div class="permission-module mb-3">
                    <div class="card-text mb-2 border-bottom pb-2 d-flex flex-column">
                      <strong>{module.name}</strong>
                    </div>
                    {module.groups.map((group, groupIndex) => (
                      <div class="permission-group ms-3 mb-3">
                        <div class="card-text mb-2 border-bottom pb-0 d-flex flex-column">
                          <span class="fw-semibold">{group.name}</span>
                        </div>
                        <div class="permission-items ms-3 d-flex flex-row flex-wrap gap-4">
                          {group.permissions.map((permission, permissionIndex) => (
                            <div class="permission-item d-flex align-items-center">
                              {selectedPermissions.some(
                                (selectedPermission) => selectedPermission.id === permission.id
                              ) ? (
                                <div class="permission-item-icon me-1 text-success">
                                  <i class="ri-checkbox-circle-fill" />
                                </div>
                              ) : (
                                <div class="permission-item-icon me-1 text-danger">
                                  <i class="ri-close-circle-fill" />
                                </div>
                              )}
                              <div class="permission-item-name">{permission.name}</div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                ))
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</AdminLayout>
